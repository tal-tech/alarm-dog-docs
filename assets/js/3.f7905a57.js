(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{327:function(a,e,t){a.exports=t.p+"assets/img/3c70ed4c73d2debdc912a957ebd8cd0192c43809e061b3f65c1423ab1e032f5c.98924427.png"},420:function(a,e,t){a.exports=t.p+"assets/img/67140110993a91a96859f84fb90a8eb03dbbcd298ca8d74716321a126e47694e.f8ea92e3.png"},421:function(a,e,t){a.exports=t.p+"assets/img/a89708b923c66ac46e7de5e421c2e54cffc06b3436dd050e9bbaeea25fb68a3a.92c46b06.png"},422:function(a,e,t){a.exports=t.p+"assets/img/51e5a2786926a1ccf11dc04d5da4f5407e3429c9cc730b4f55ca03c959e3f92b.705f9d22.png"},423:function(a,e,t){a.exports=t.p+"assets/img/89d2f12f2938e73ea46289aa60ca515290fc7127d9ad8ff2b76f8b3a5c2b52fc.48d07865.png"},424:function(a,e,t){a.exports=t.p+"assets/img/47aab321332d81fc62daf157db596160f7160f4200575504ec0f22ee0a023e86.4fa3fa22.png"},425:function(a,e,t){a.exports=t.p+"assets/img/1054d7ca1c784308a83e9095aa51080e763266308c560d7b6579b6e8a50adee3.3efe98da.png"},426:function(a,e,t){a.exports=t.p+"assets/img/c19483e1a5129e097e0f2bdd6142e1330a7bff22b8f1b0e185fc1fb087133b4f.0fca187e.png"},427:function(a,e,t){a.exports=t.p+"assets/img/8c7cb538de614d0854650e2158726ba96a63fe07fd544568bd373432242dda5c.85ff8d74.png"},428:function(a,e,t){a.exports=t.p+"assets/img/ddf74867c5cb8243188c61c0c3d947e94c4b1f76ea53ada21bd3ecb903a35d2a.4e2faaa6.png"},429:function(a,e,t){a.exports=t.p+"assets/img/018b8afb8d0e7a6d688b833ae12f972993dd947e04d662fbc6d371e869d83bcf.23fb3902.png"},430:function(a,e,t){a.exports=t.p+"assets/img/4e020d07ed7ce291f83b90a9002e368ad505b435482e710e18adc5ecf478e8f8.1b02845c.png"},431:function(a,e,t){a.exports=t.p+"assets/img/a2960c86ac0a125ac38057127461ed99a76ec9821957ecabe0f9152654b63aef.ccb728cf.png"},432:function(a,e,t){a.exports=t.p+"assets/img/ee06db6b3f8ad72a05e4ec48d32c3a42b01c5ba33bf0a94fe2d1b260081f2e32.a4de1772.png"},474:function(a,e,t){"use strict";t.r(e);var s=t(25),c=Object(s.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"怎么配置钉钉机器人（钉钉群）通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#怎么配置钉钉机器人（钉钉群）通知"}},[a._v("#")]),a._v(" 怎么配置钉钉机器人（钉钉群）通知")]),a._v(" "),s("p",[a._v("在创建告警任务或者告警通知组时，您可能会遇到要配置钉钉机器人（钉钉群）的告警通知，例如下面这样：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(420),alt:"图 29"}})]),a._v(" "),s("p",[a._v("首先点击添加机器人，页面会出现 "),s("code",[a._v("WebToken")]),a._v(" 和 "),s("code",[a._v("Secret")]),a._v(" 两个配置，如果下图所示：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(421),alt:"图 30"}})]),a._v(" "),s("p",[a._v("下面讲解如何配置钉钉机器人。")]),a._v(" "),s("h2",{attrs:{id:"钉钉机器人配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#钉钉机器人配置"}},[a._v("#")]),a._v(" 钉钉机器人配置")]),a._v(" "),s("p",[a._v("进入到钉钉，找一个群，没有则创建，然后点击群右上角群设置，点击智能群助手展开机器人配置：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(422),alt:"图 31"}})]),a._v(" "),s("p",[a._v("点击添加机器人创建按钮：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(423),alt:"图 32"}})]),a._v(" "),s("p",[a._v("然后点击如下图所示位置：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(424),alt:"图 33"}})]),a._v(" "),s("p",[a._v("选择自定义：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(425),alt:"图 34"}})]),a._v(" "),s("p",[a._v("然后点添加，机器人名称自定义，根据实际情况填写，例如 "),s("code",[a._v("哮天犬监控告警平台")])]),a._v(" "),s("p",[s("img",{attrs:{src:t(426),alt:"图 35"}})]),a._v(" "),s("p",[a._v("如上图所示，将截图中指的 "),s("code",[a._v("加签")]),a._v(" 下方的Secret复制到浏览器页面：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(427),alt:"图 36"}})]),a._v(" "),s("p",[a._v("接着回到钉钉添加机器人页面，点击完成，得到如下面截图所示的Webhook，然后复制：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(428),alt:"图 37"}})]),a._v(" "),s("p",[a._v("然后回到浏览器粘贴复制的Webhook的值，当浏览器输入框失去焦点时会自动提取Webhook的中的 "),s("code",[a._v("access_token")]),a._v(" 的值：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(429),alt:"图 38"}})]),a._v(" "),s("p",[s("img",{attrs:{src:t(430),alt:"图 39"}})]),a._v(" "),s("p",[a._v("至此，一个机器人就配置好了，下面我们可以测试一下我们的配置是否正确，点击绿色的测试按钮，如果成功，机器人会发送一条测试通知，如果失败，浏览器端会提示具体错误：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(431),alt:"图 40"}})]),a._v(" "),s("p",[a._v("测试成功，机器人会收到如下通知：")]),a._v(" "),s("p",[s("img",{attrs:{src:t(432),alt:"图 41"}})]),a._v(" "),s("p",[a._v("至此，一个机器人的配置及测试全部完成。")]),a._v(" "),s("h2",{attrs:{id:"多个机器人的配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多个机器人的配置"}},[a._v("#")]),a._v(" 多个机器人的配置")]),a._v(" "),s("p",[a._v("如果你需要配置多个机器人，只需要点击添加机器人按钮创建多个机器人配置项，然后重复上面的步骤重复 "),s("a",{attrs:{href:"#%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA%E9%85%8D%E7%BD%AE"}},[a._v("钉钉机器人配置")]),a._v(" 创建多个机器人，一个钉钉群可以配置最多5个自定义机器人。")]),a._v(" "),s("h2",{attrs:{id:"为什么要配置多个机器人"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么要配置多个机器人"}},[a._v("#")]),a._v(" 为什么要配置多个机器人")]),a._v(" "),s("p",[a._v("钉钉官方对单个机器人进行了限制，每个机器人一分钟最多允许发送20个通知，如果超过则会限流，甚至禁言10分钟。为了减少这种事情发生，哮天犬支持配置多个机器人，这多个机器人并不是说发送通知时给这些机器人一起发送，而是优先第一个发送，当第一个机器人一分钟发送超过了19次，则进入 "),s("code",[a._v("sleep")]),a._v(" 状态，使用下一个机器人发送，依次类推，如果配置5个机器人，则一分钟最多可以接收 19*5 = 95 条告警，较之前多5倍，这样就从侧面增加了群接收告警的能力。")]),a._v(" "),s("h2",{attrs:{id:"怎样能让告警同时给多个群发送"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#怎样能让告警同时给多个群发送"}},[a._v("#")]),a._v(" 怎样能让告警同时给多个群发送")]),a._v(" "),s("p",[a._v("由于前期设计未考虑这种情况，所以这种场景原则上是不支持的，但是可以利用 "),s("code",[a._v("分级告警")]),a._v(" 功能去实现这种功能。")]),a._v(" "),s("p",[s("img",{attrs:{src:t(327),alt:"图 42"}})]),a._v(" "),s("p",[a._v("按照上面截图中所示进行配置，即可实现告警通知发给多个机器人，如果需要配置更多个，重复上面的分级告警即可，添加多个分级条件组。")]),a._v(" "),s("h2",{attrs:{id:"为什么收不到告警通知"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么收不到告警通知"}},[a._v("#")]),a._v(" 为什么收不到告警通知")]),a._v(" "),s("ol",[s("li",[a._v("检查钉钉机器人配置是否正确，可以按照 "),s("a",{attrs:{href:"#%E9%92%89%E9%92%89%E6%9C%BA%E5%99%A8%E4%BA%BA%E9%85%8D%E7%BD%AE"}},[a._v("钉钉机器人配置")]),a._v(" 中的机器人测试来检查，如果存在问题，请修改，最多20s即可生效；")]),a._v(" "),s("li",[a._v("检查钉钉机器人是不是短时间已发送大量告警通知，查看群中1分钟内机器人发送的告警的数量是否超过 "),s("code",[a._v("N * 19")]),a._v(" ，其中 "),s("code",[a._v("N")]),a._v(" 为在哮天犬配置的机器人的个数；")]),a._v(" "),s("li",[a._v("有可能因哮天犬服务端大量发送告警通知，导致服务端IP被封，该问题目前暂时无法解决，建议您同时配置知音楼机器人避免钉钉封掉告警通知；")])]),a._v(" "),s("h2",{attrs:{id:"备注说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#备注说明"}},[a._v("#")]),a._v(" 备注说明")]),a._v(" "),s("p",[a._v("钉钉工作通知和机器人通知限制特别严重，请配置好告警收敛减少重复类告警发送（告警收敛请移步 "),s("RouterLink",{attrs:{to:"/advance-function/compress.html"}},[a._v("告警收敛")]),a._v("），请配置知音楼告警通知作为保底。")],1)])}),[],!1,null,null,null);e.default=c.exports}}]);