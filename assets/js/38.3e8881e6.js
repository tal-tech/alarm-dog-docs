(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{485:function(t,s,a){"use strict";a.r(s);var e=a(25),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"接口签名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#接口签名"}},[t._v("#")]),t._v(" 接口签名")]),t._v(" "),a("h2",{attrs:{id:"鉴权说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#鉴权说明"}},[t._v("#")]),t._v(" 鉴权说明")]),t._v(" "),a("p",[t._v("OpenAPI 是操作告警任务等哮天犬后台数据的相关接口。与告警接口不同，鉴权方式也稍有不同")]),t._v(" "),a("p",[t._v("主要分为两步：")]),t._v(" "),a("ul",[a("li",[t._v("应用鉴权（必须）")]),t._v(" "),a("li",[t._v("任务鉴权（非告警任务操作不需要任务鉴权）")])]),t._v(" "),a("p",[t._v("应用鉴权是必须的，如果存在应用鉴权，则两种鉴权需要一起使用。")]),t._v(" "),a("h2",{attrs:{id:"应用鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用鉴权"}},[t._v("#")]),t._v(" 应用鉴权")]),t._v(" "),a("p",[a("strong",[t._v("OpenAPI 涉及的所有接口都必须使用应用鉴权")])]),t._v(" "),a("p",[t._v("为了减少误解及不必要的学习成本，该规则采用API网关鉴权相同的规则，即：")]),t._v(" "),a("p",[a("code",[t._v("sign = md5(appid + '&' + timestamp + token)")])]),t._v(" "),a("blockquote",[a("p",[t._v("appid 和 token 需要向系统管理员申请")]),t._v(" "),a("p",[t._v("此处 "),a("code",[t._v("+")]),t._v(" 符号表示字符串连接符")]),t._v(" "),a("p",[t._v("timestamp（单位秒、Unix 时间戳），要求与哮天犬系统时间差不超过 30 分钟")])]),t._v(" "),a("p",[t._v("然后将三个参数放入请求Header参数中：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X GET http://localhost:9501/openapi/department "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Dog-Appid: 385732'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Dog-TimeStamp: 1595847866'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'X-Dog-Sign: d7d45f31a245abb9125f3xxxxxx'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[a("a",{attrs:{href:"http://10.90.101.114/gateway.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("在线签名生成"),a("OutboundLink")],1),t._v("，AppID 处填写 appid，AppKey 处填写 token")]),t._v(" "),a("h2",{attrs:{id:"任务鉴权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#任务鉴权"}},[t._v("#")]),t._v(" 任务鉴权")]),t._v(" "),a("p",[a("strong",[t._v("OpenAPI 任务相关操作需要任务鉴权")])]),t._v(" "),a("p",[t._v("此任务是哮天犬告警平台的告警任务。即存在告警任务、操作告警任务时才有该鉴权。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("例：创建告警任务、部门列表等接口调用时应不存在具体应用，所以"),a("strong",[t._v("不需要")]),t._v("任务鉴权。")])]),t._v(" "),a("li",[a("p",[t._v("例：编辑告警任务、删除告警任务接口调用时存在具体应用，所以"),a("strong",[t._v("需要")]),t._v("任务鉴权。")])])]),t._v(" "),a("p",[t._v("为了减少误解及不必要的学习成本，该规则采用API网关鉴权相同的规则，即：")]),t._v(" "),a("p",[a("code",[t._v("sign = md5(id + '&' + timestamp + secret)")])]),t._v(" "),a("blockquote",[a("p",[t._v("id: 任务生成的参数id")]),t._v(" "),a("p",[t._v("secret: 创建任务后生成的secret")]),t._v(" "),a("p",[t._v("timestamp（单位秒、Unix 时间戳），要求与哮天犬系统时间差不超过 30 分钟。")])]),t._v(" "),a("p",[t._v("然后将三个参数放入请求参数中：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST http://myopenapi.com "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{ "id": id, "timestamp": timestamp, "sign": sign }\'')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("blockquote",[a("p",[t._v("以上三个参数可以放在请求参数的 query、body 参数中")])]),t._v(" "),a("p",[a("a",{attrs:{href:"http://10.90.101.114/gateway.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("在线签名生成"),a("OutboundLink")],1),t._v("，AppID 处填写 appid，AppKey 处填写 secret")])])}),[],!1,null,null,null);s.default=n.exports}}]);