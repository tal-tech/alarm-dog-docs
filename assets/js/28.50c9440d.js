(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{462:function(t,s,a){"use strict";a.r(s);var n=a(25),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"告警接口api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#告警接口api"}},[t._v("#")]),t._v(" 告警接口API")]),t._v(" "),a("p",[t._v("哮天犬提供了不同语言的告警SDK，SDK实现了所有的告警接口，建议您优先使用SDK，告警SDK请移步："),a("RouterLink",{attrs:{to:"/sdk/summary-alarm.html"}},[t._v("哮天犬告警SDK")]),t._v("。")],1),t._v(" "),a("p",[t._v("使用告警接口或者告警SDK之前，请注意区分环境，测试环境后台创建的任务请使用测试环境的告警接口，生产环境后台创建的告警任务请使用生产环境的告警接口，接口环境说明请移步："),a("RouterLink",{attrs:{to:"/alarm/api-env.html"}},[t._v("接口环境说明")]),t._v("。")],1),t._v(" "),a("h2",{attrs:{id:"告警上报接口-alarm-report"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#告警上报接口-alarm-report"}},[t._v("#")]),t._v(" 告警上报接口-/alarm/report")]),t._v(" "),a("p",[a("code",[t._v("POST /alarm/report")])]),t._v(" "),a("p",[t._v("用于发送告警，所有告警全部使用该接口。")]),t._v(" "),a("p",[a("strong",[t._v("Request Headers:")])]),t._v(" "),a("ul",[a("li",[t._v("Content-Type: application/json")])]),t._v(" "),a("p",[a("strong",[t._v("Request Parameters:")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Comment")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("taskid")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("告警任务ID，创建告警任务获得")])]),t._v(" "),a("tr",[a("td",[t._v("timestamp")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("时间戳，单位秒，与标准时间前后误差不能超过30分钟")])]),t._v(" "),a("tr",[a("td",[t._v("sign")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("接口签名，根据 "),a("code",[t._v('md5(taskid+"&"+timestamp+token)')]),t._v(" 算法生成，具体请参考附录： "),a("a",{attrs:{href:"#_1-%E5%AF%B9%E5%A4%96api%E6%8E%A5%E5%8F%A3%E9%89%B4%E6%9D%83%E8%A7%84%E5%88%99%E8%AF%B4%E6%98%8E"}},[t._v("对外API接口鉴权规则说明")])])]),t._v(" "),a("tr",[a("td",[t._v("ctn")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("告警内容，Json对象格式，可以根据业务情况填任意字段，"),a("strong",[t._v("建议")]),t._v("至少包含errno、error、trace三个字段")])]),t._v(" "),a("tr",[a("td",[t._v("notice_time")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("告警通知时间，时间戳，单位秒，默认为告警平台接收到告警生成的时间戳")])]),t._v(" "),a("tr",[a("td",[t._v("level")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("告警级别，仅做标记或者告警中条件判断，枚举类型，0-通知；1-警告；2-错误；3-紧急；")])]),t._v(" "),a("tr",[a("td",[t._v("receiver")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("自定义告警接收人，不推荐使用，指定告警接收人之后会"),a("strong",[t._v("强制覆盖")]),t._v("任务中预定义的告警接收人，会导致通过后台配置的告警通知人失效，适用于网关、日志中心这种综合性平台的特殊场景")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.alarmgroup")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("告警组ID列表，如果告警组和下方自定义的通知渠道同时使用，将取并集进行发送告警")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("自定义告警渠道配置信息")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.dinggroup")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("告警接收钉钉机器人，每个item为 webhook 和 secret 的配置")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.dinggroup.*.webhook")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("钉钉机器人webhook的access_token的值")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.dinggroup.*.secret")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("钉钉机器人安全设置中加密下面一行的密钥")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.dingworker")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("钉钉工作通知，用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.yachgroup")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("告警接收知音楼机器人，每个item为 webhook 和 secret 的配置")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.yachgroup.*.webhook")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("知音楼机器人webhook的access_token字段的值")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.yachgroup.*.secret")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("知音楼机器人密钥")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.yachworker")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("知音楼工作通知，用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.email")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("邮件通知，用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.sms")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("短信通知，用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.phone")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("电话通知，用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.wechat")]),t._v(" "),a("td",[t._v("Array")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("微信通知（暂不支持），用户工号列表，不带前面数字0，比如01写为1")])]),t._v(" "),a("tr",[a("td",[t._v("receiver.channels.webhook")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("N")]),t._v(" "),a("td",[t._v("Webhook通知，必须以http/https协议开头的有效URL")])])])]),t._v(" "),a("p",[a("strong",[t._v("Request Body:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"taskid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1582650647")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sign"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"md5(taskid+"')]),t._v("&"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+timestamp+token)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ctn"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"errno"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10086")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"网络信号不好"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hostname"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bj-sjhl-alarm-online"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"notice_time"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1583230743")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"level"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"receiver"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"alarmgroup"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"channels"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dinggroup"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webhook"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxxxxxxxxxxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"secret"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"XXXXXXXXXXXXXXXXXXX"')]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dingworker"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"yachgroup"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"webhook"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxxxxxxxxxxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"secret"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"XXXXXXXXXXXXXXXXXXX"')]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"yachworker"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"email"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sms"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"wechat"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"phone"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("98333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33333")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br"),a("span",{staticClass:"line-number"},[t._v("40")]),a("br"),a("span",{staticClass:"line-number"},[t._v("41")]),a("br"),a("span",{staticClass:"line-number"},[t._v("42")]),a("br"),a("span",{staticClass:"line-number"},[t._v("43")]),a("br"),a("span",{staticClass:"line-number"},[t._v("44")]),a("br"),a("span",{staticClass:"line-number"},[t._v("45")]),a("br"),a("span",{staticClass:"line-number"},[t._v("46")]),a("br"),a("span",{staticClass:"line-number"},[t._v("47")]),a("br"),a("span",{staticClass:"line-number"},[t._v("48")]),a("br"),a("span",{staticClass:"line-number"},[t._v("49")]),a("br"),a("span",{staticClass:"line-number"},[t._v("50")]),a("br"),a("span",{staticClass:"line-number"},[t._v("51")]),a("br"),a("span",{staticClass:"line-number"},[t._v("52")]),a("br"),a("span",{staticClass:"line-number"},[t._v("53")]),a("br")])]),a("p",[a("strong",[t._v("Response:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uuid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"report_time"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2020-02-02 12:12:12"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Comment")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("code")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("状态码：0-成功；其他-失败")])]),t._v(" "),a("tr",[a("td",[t._v("msg")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("错误信息，以 "),a("code",[t._v("code")]),t._v(" 的值为准")])]),t._v(" "),a("tr",[a("td",[t._v("data")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("响应结果")])]),t._v(" "),a("tr",[a("td",[t._v("data.uuid")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("该告警信息唯一ID，基于uuid v4版本生成")])]),t._v(" "),a("tr",[a("td",[t._v("data.report_time")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("告警上报时间，即告警平台接收到告警的实际")])])])]),t._v(" "),a("h2",{attrs:{id:"告警测试接口-alarm-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#告警测试接口-alarm-test"}},[t._v("#")]),t._v(" 告警测试接口-/alarm/test")]),t._v(" "),a("p",[a("code",[t._v("POST /alarm/test")])]),t._v(" "),a("p",[t._v("用于测试签名是否正确，可以用于刚接入哮天犬告警接口时签名调试工作，用于平台化配置哮天犬告警场景，例如k8s构建通知可以配置哮天犬告警通知，为了避免任务ID "),a("code",[t._v("taskid")]),t._v(" 和 "),a("code",[t._v("token")]),t._v(" 填写错误，可以调用此接口验证 "),a("code",[t._v("taskid")]),t._v(" 和 "),a("code",[t._v("token")]),t._v(" 是否填写正确，但不会实际发生告警。")]),t._v(" "),a("p",[a("strong",[t._v("Request Headers:")])]),t._v(" "),a("ul",[a("li",[t._v("Content-Type: application/json")])]),t._v(" "),a("p",[a("strong",[t._v("Request Parameters:")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Comment")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("taskid")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("告警任务ID，创建告警任务获得")])]),t._v(" "),a("tr",[a("td",[t._v("timestamp")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("时间戳，单位秒，与标准时间前后误差不能超过30分钟")])]),t._v(" "),a("tr",[a("td",[t._v("sign")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("Y")]),t._v(" "),a("td",[t._v("接口签名，根据 "),a("code",[t._v('md5(taskid+"&"+timestamp+token)')]),t._v(" 算法生成，具体请参考附录： "),a("a",{attrs:{href:"#_1-%E5%AF%B9%E5%A4%96api%E6%8E%A5%E5%8F%A3%E9%89%B4%E6%9D%83%E8%A7%84%E5%88%99%E8%AF%B4%E6%98%8E"}},[t._v("对外API接口鉴权规则说明")])])])])]),t._v(" "),a("p",[a("strong",[t._v("Request Body:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"taskid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1582650647")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sign"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"md5(taskid+\\"&\\"+timestamp+token)"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[a("strong",[t._v("Response:")])]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Comment")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("code")]),t._v(" "),a("td",[t._v("Number")]),t._v(" "),a("td",[t._v("状态码：0-成功；其他-失败")])]),t._v(" "),a("tr",[a("td",[t._v("msg")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("错误信息，以 "),a("code",[t._v("code")]),t._v(" 的值为准")])]),t._v(" "),a("tr",[a("td",[t._v("data")]),t._v(" "),a("td",[t._v("Object")]),t._v(" "),a("td",[t._v("响应结果，此处为空")])])])]),t._v(" "),a("p",[t._v("失败时返回：")]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"signature invalid"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h2",{attrs:{id:"附录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[t._v("#")]),t._v(" 附录")]),t._v(" "),a("h3",{attrs:{id:"_1-对外api接口鉴权规则说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-对外api接口鉴权规则说明"}},[t._v("#")]),t._v(" 1. 对外API接口鉴权规则说明")]),t._v(" "),a("p",[t._v("该鉴权需要"),a("code",[t._v("taskid")]),t._v("和"),a("code",[t._v("token")]),t._v("两个字段，任务创建之后可以获得，并且如果泄露，可以前往哮天犬平台重置")]),t._v(" "),a("p",[t._v("为了减少误解及不必要的学习成本，该规则采用API网关鉴权相同的规则，即：")]),t._v(" "),a("p",[a("code",[t._v('sign = md5(taskid+"&"+timestamp+token)')]),t._v(" ，其中 "),a("code",[t._v("taskid")]),t._v(" 为任务ID，"),a("code",[t._v("timestamp")]),t._v(" 为当前系统时间戳，单位秒，与哮天犬系统时间相差不超过半小时，"),a("code",[t._v("token")]),t._v(" 为创建任务之后生成")]),t._v(" "),a("p",[t._v("然后将三个参数放入请求参数中：")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -X POST "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://alarm-dog-service.domain.com/alarm/report'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -H "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type: application/json'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{\n        "taskid": taskid,\n        "timestamp": timestamp,\n        "sign": "sign",\n        "ctn": {\n        \n        }\n    }\'')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("p",[t._v("在线签名生成，AppID处填写taskid，AppKey处填写token："),a("a",{attrs:{href:"http://10.90.101.114/gateway.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://10.90.101.114/gateway.php"),a("OutboundLink")],1),t._v("（此处只需要使用该算法即可，不用加上Header（X-Auth-APPID））")])])}),[],!1,null,null,null);s.default=r.exports}}]);