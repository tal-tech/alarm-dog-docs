(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{366:function(a,e,t){a.exports=t.p+"assets/img/7c8b2c8f3bb83e96768effc34a21e7ec3b2b6e6e73df55799a4cdcd2efcc4643.d3e0f3f2.png"},367:function(a,e,t){a.exports=t.p+"assets/img/910432cfb43618729b70d07df855e716df419368201f3d7e204d992ca2b12fee.f1eae9aa.png"},368:function(a,e,t){a.exports=t.p+"assets/img/1f49c54baa0194f90e2628c05152b57bcef75a9dd9f6338f5f400a34f7d1257e.668667cc.png"},369:function(a,e,t){a.exports=t.p+"assets/img/8e103ae5a95ff64965bb7aece82392ba43f5240824768f11dba29754394eb676.7fa22e45.png"},370:function(a,e,t){a.exports=t.p+"assets/img/e874c61f8c457c0524861a262fc2b9ecba819ff682182517995e0cdd81e05706.b6ce4587.png"},371:function(a,e,t){a.exports=t.p+"assets/img/a1ca5a93f8a509999d6598c51b3bae841e669927a9228b1cb5eb145d8815d7f9.f8054d95.png"},372:function(a,e,t){a.exports=t.p+"assets/img/b00ea2aab2c48363a4b7e41a2897e7fea99aa99ba652b7ede3472be2151f978f.4b333347.png"},373:function(a,e,t){a.exports=t.p+"assets/img/e5e3ff83fcd9258c60d45d8165463927d7a70d3c1d45ef04a6826ac0c381fab0.2f591077.png"},464:function(a,e,t){"use strict";t.r(e);var r=t(25),s=Object(r.a)({},(function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("p",[a._v("Prometheus是一个非常强大的监控工具，但本身不具备告警功能，告警功能主要通过 Grafana 或者 AlertManager 等工具来实现，Grafana的告警接入请参考："),r("RouterLink",{attrs:{to:"/alarm/grafana.html"}},[a._v("Grafana告警接入")]),a._v("。AlertManager的告警接入请参考本篇接入文档进行接入。")],1),a._v(" "),r("h2",{attrs:{id:"step1：创建哮天犬告警任务"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#step1：创建哮天犬告警任务"}},[a._v("#")]),a._v(" Step1：创建哮天犬告警任务")]),a._v(" "),r("p",[a._v("前往哮天犬后台 "),r("a",{attrs:{href:"https://alarm-dog.domain.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://alarm-dog.domain.com"),r("OutboundLink")],1),a._v("，在告警任务菜单页点击创建告警任务，基本信息、告警通知人等根据实际情况填写，自动恢复和通知模板需要特殊配置一下，否则发送出来的内容可读性非常差。")]),a._v(" "),r("p",[a._v("在自动恢复这里，开启自动恢复，并选择恢复方式为 "),r("code",[a._v("条件恢复")]),a._v("，然后字段填写 "),r("code",[a._v("ctn.status")]),a._v("，条件选择 "),r("code",[a._v("等于")]),a._v("，阈值填写 "),r("code",[a._v("resolved")]),a._v("。至此，自动恢复已配置完成。")]),a._v(" "),r("p",[r("img",{attrs:{src:t(366),alt:"图 1"}})]),a._v(" "),r("p",[a._v("接着切换到通知模板，然后搜索 "),r("code",[a._v("alertmanager告警模板")]),a._v("，选择该模板：")]),a._v(" "),r("p",[r("img",{attrs:{src:t(367),alt:"图 2"}})]),a._v(" "),r("p",[a._v("如果觉得默认模板不满意，可以选中之后，点另存为重新编辑，保存之后搜索另存为的模板名称即可：")]),a._v(" "),r("p",[r("img",{attrs:{src:t(368),alt:"图 3"}})]),a._v(" "),r("p",[r("img",{attrs:{src:t(369),alt:"图 4"}})]),a._v(" "),r("p",[a._v("有关告警模板的编辑，请参考："),r("RouterLink",{attrs:{to:"/advance-function/alarm-template.html"}},[a._v("告警模板")])],1),a._v(" "),r("h2",{attrs:{id:"step2：获取alertmanager告警的url"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#step2：获取alertmanager告警的url"}},[a._v("#")]),a._v(" Step2：获取AlertManager告警的URL")]),a._v(" "),r("p",[a._v("告警任务创建完成之后，页面会自动跳转到告警任务详情页，在详情页，找到Grafana告警这一项，然后复制该URL以备使用。")]),a._v(" "),r("p",[r("img",{attrs:{src:t(370),alt:"图 6"}})]),a._v(" "),r("h2",{attrs:{id:"step3：在alertmanager中配置webhook"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#step3：在alertmanager中配置webhook"}},[a._v("#")]),a._v(" Step3：在AlertManager中配置webhook")]),a._v(" "),r("p",[a._v("编辑AlertManager的配置文件，默认路径为 "),r("code",[a._v("/etc/alertmanager/alertmanager.yml")]),a._v("，或者使用docker的自行修改对应挂载的文件，在对应的 "),r("code",[a._v("receivers")]),a._v(" 中增加 "),r("code",[a._v("webhook_config")]),a._v(" 的配置，且务必配置 "),r("code",[a._v("send_resolved: true")]),a._v("，否则无法发送恢复通知，告警恢复不可用。")]),a._v(" "),r("p",[r("img",{attrs:{src:t(371),alt:"图 7"}})]),a._v(" "),r("h2",{attrs:{id:"实际效果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#实际效果"}},[a._v("#")]),a._v(" 实际效果")]),a._v(" "),r("p",[a._v("如果一旦有告警，会在哮天犬配置的任务中的各通知渠道发送告警，下面截图是告警发送到知音楼群的示例：")]),a._v(" "),r("p",[r("img",{attrs:{src:t(372),alt:"图 8"}})]),a._v(" "),r("p",[a._v("如果告警恢复，则会收到如下告警：")]),a._v(" "),r("p",[r("img",{attrs:{src:t(373),alt:"图 9"}})]),a._v(" "),r("p",[a._v("如果觉得发送的告警比较丑，想自己优化，请参考 "),r("a",{attrs:{href:"#step1%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%93%AE%E5%A4%A9%E7%8A%AC%E5%91%8A%E8%AD%A6%E4%BB%BB%E5%8A%A1"}},[a._v("#Step1")]),a._v(" 中的告警通知模板另存为的说明。")])])}),[],!1,null,null,null);e.default=s.exports}}]);