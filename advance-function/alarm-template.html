<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>告警通知模板 | 哮天犬监控告警平台</title>
    <meta name="generator" content="VuePress 1.5.1">
    <link rel="icon" href="/alarm-dog-docs/logo.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/alarm-dog-docs/assets/css/0.styles.fa7f8589.css" as="style"><link rel="preload" href="/alarm-dog-docs/assets/js/app.af20afb1.js" as="script"><link rel="preload" href="/alarm-dog-docs/assets/js/2.d68acc10.js" as="script"><link rel="preload" href="/alarm-dog-docs/assets/js/11.a92c3c0c.js" as="script"><link rel="prefetch" href="/alarm-dog-docs/assets/js/10.cb6ca97d.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/12.76d19118.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/13.ad7a966f.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/14.36a3d3a1.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/15.2a85f4ac.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/16.ca4273b3.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/17.378d4cb9.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/18.3353ecac.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/19.3f341f38.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/20.96bbd9b0.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/21.acb8eeca.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/22.72703b70.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/23.56d9c294.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/24.c17773da.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/25.220a3672.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/26.7b01d31a.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/27.c46811fb.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/28.50c9440d.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/29.732e0676.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/3.f7905a57.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/30.fb65c9ab.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/31.a3ce1a14.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/32.637a07d3.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/33.f910a9c6.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/34.4b681ac9.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/35.15025639.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/36.fed83712.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/37.621375e2.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/38.3e8881e6.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/39.809699a6.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/4.68ef241b.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/40.506ca957.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/41.dfaca082.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/42.9fee1072.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/43.1dec01a8.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/44.a782f35e.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/45.36b08e1f.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/46.c132113d.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/47.a7dba454.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/48.efd0b31e.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/5.e8f5974a.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/6.1ca87934.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/7.84dc2d65.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/8.764ad4f3.js"><link rel="prefetch" href="/alarm-dog-docs/assets/js/9.8541817f.js">
    <link rel="stylesheet" href="/alarm-dog-docs/assets/css/0.styles.fa7f8589.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/alarm-dog-docs/" class="home-link router-link-active"><img src="/alarm-dog-docs/logo.png" alt="哮天犬监控告警平台" class="logo"> <span class="site-name can-hide">哮天犬监控告警平台</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/tal-tech/alarm-dog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/tal-tech/alarm-dog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/preface/introduction.html" class="sidebar-link">项目介绍</a></li><li><a href="/alarm-dog-docs/preface/platform-arch.html" class="sidebar-link">平台架构</a></li><li><a href="/alarm-dog-docs/preface/concept.html" class="sidebar-link">概念介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>告警接入</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/alarm/quick-start.html" class="sidebar-link">快速入门</a></li><li><a href="/alarm-dog-docs/alarm/alarm-api.html" class="sidebar-link">告警接口API</a></li><li><a href="/alarm-dog-docs/alarm/aliyun.html" class="sidebar-link">阿里云告警接入</a></li><li><a href="/alarm-dog-docs/alarm/arms.html" class="sidebar-link">阿里云Arms告警接入</a></li><li><a href="/alarm-dog-docs/alarm/grafana.html" class="sidebar-link">Grafana告警接入</a></li><li><a href="/alarm-dog-docs/alarm/falcon.html" class="sidebar-link">OpenFalcon告警接入</a></li><li><a href="/alarm-dog-docs/alarm/alertmanager.html" class="sidebar-link">AlertManager告警接入</a></li><li><a href="/alarm-dog-docs/alarm/webhook-notice-data-format.html" class="sidebar-link">WebHook通知数据交互格式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SDK</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/sdk/summary-alarm.html" class="sidebar-link">哮天犬告警SDK</a></li><li><a href="/alarm-dog-docs/sdk/php-alarm.html" class="sidebar-link">PHP告警SDK</a></li><li><a href="/alarm-dog-docs/sdk/golang-alarm.html" class="sidebar-link">Golang告警SDK</a></li><li><a href="/alarm-dog-docs/sdk/java-alarm.html" class="sidebar-link">Java告警SDK</a></li><li><a href="/alarm-dog-docs/sdk/shell-alarm.html" class="sidebar-link">Shell脚本告警示例</a></li><li><a href="/alarm-dog-docs/sdk/nodejs-alarm.html" class="sidebar-link">NodeJs脚本告警示例</a></li><li><a href="/alarm-dog-docs/sdk/hyperf-noticer.html" class="sidebar-link">哮天犬通知SDK</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>监控接入</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/monitor/protocol-detect.html" class="sidebar-link">心跳探活</a></li><li><a href="/alarm-dog-docs/monitor/universal.html" class="sidebar-link">通用监控</a></li><li><a href="/alarm-dog-docs/monitor/cycle-compare.html" class="sidebar-link">同比环比监控</a></li><li><a href="/alarm-dog-docs/monitor/data-source.html" class="sidebar-link">数据源</a></li><li><a href="/alarm-dog-docs/monitor/cycle-compare-datainit.html" class="sidebar-link">同比环比数据初始化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>高级功能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/advance-function/compress.html" class="sidebar-link">告警收敛</a></li><li><a href="/alarm-dog-docs/advance-function/filter.html" class="sidebar-link">告警过滤</a></li><li><a href="/alarm-dog-docs/advance-function/upgrade.html" class="sidebar-link">告警升级</a></li><li><a href="/alarm-dog-docs/advance-function/workflow.html" class="sidebar-link">告警工作流</a></li><li><a href="/alarm-dog-docs/advance-function/receiver.html" class="sidebar-link">告警通知人</a></li><li><a href="/alarm-dog-docs/advance-function/dispatcher.html" class="sidebar-link">分级告警</a></li><li><a href="/alarm-dog-docs/advance-function/alarm-template.html" aria-current="page" class="active sidebar-link">告警模板</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#通知模板配置" class="sidebar-link">通知模板配置</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#模板场景" class="sidebar-link">模板场景</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警被收敛" class="sidebar-link">告警被收敛</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警未收敛" class="sidebar-link">告警未收敛</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警升级" class="sidebar-link">告警升级</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警恢复" class="sidebar-link">告警恢复</a></li></ul></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#模板类型" class="sidebar-link">模板类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#预定义模板" class="sidebar-link">预定义模板</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#自定义模板" class="sidebar-link">自定义模板</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#默认模板" class="sidebar-link">默认模板</a></li></ul></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#可用模板变量" class="sidebar-link">可用模板变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警收敛场景" class="sidebar-link">告警收敛场景</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警未收敛场景" class="sidebar-link">告警未收敛场景</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警升级场景" class="sidebar-link">告警升级场景</a></li><li class="sidebar-sub-header"><a href="/alarm-dog-docs/advance-function/alarm-template.html#告警恢复场景" class="sidebar-link">告警恢复场景</a></li></ul></li></ul></li><li><a href="/alarm-dog-docs/advance-function/recovery.html" class="sidebar-link">自动恢复</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开放平台</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/openapi/introduction.html" class="sidebar-link">开放平台</a></li><li><a href="/alarm-dog-docs/openapi/app-apply.html" class="sidebar-link">应用申请</a></li><li><a href="/alarm-dog-docs/openapi/api-sign.html" class="sidebar-link">接口签名</a></li><li><a href="/alarm-dog-docs/openapi/api.html" class="sidebar-link">接口列表</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>常见问题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/alarm-dog-docs/faq/summary.html" class="sidebar-link">问题汇总</a></li><li><a href="/alarm-dog-docs/faq/how-to-config-dinggroup.html" class="sidebar-link">怎么配置钉钉机器人告警</a></li><li><a href="/alarm-dog-docs/faq/how-to-config-yachgroup.html" class="sidebar-link">怎么配置知音楼机器人告警</a></li><li><a href="/alarm-dog-docs/faq/cannot-receiver-sms-phone.html" class="sidebar-link">收不到短信和电话</a></li><li><a href="/alarm-dog-docs/faq/how-to-use-webhook.html" class="sidebar-link">Webhook怎么用</a></li><li><a href="/alarm-dog-docs/faq/how-to-find-alarm-content.html" class="sidebar-link">怎么找到告警内容</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>告警通知模板提供了根据告警内容组装发送内容的能力，比如告警内容中发送的都是json，可以将json中的数据组合发送到通知人。</p> <h2 id="通知模板配置"><a href="#通知模板配置" class="header-anchor">#</a> 通知模板配置</h2> <p>暂且先不说预定义、自定义和默认模板的区别，先说下通知模板如何配置。</p> <p>比如现在有一个告警，告警内容为一个复杂的JSON，如下所示（为简化，下面其他示例只会展示 <code>ctn</code> 字段的内容）：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -X POST <span class="token string">'https://alarm-dog-service.domain.com/alarm/report'</span> <span class="token punctuation">\</span>
    -H <span class="token string">'Content-Type: application/json'</span> <span class="token punctuation">\</span>
    -d <span class="token string">'{
        &quot;taskid&quot;: 123,
        &quot;timestamp&quot;: 1592378746,
        &quot;sign&quot;: &quot;c039ad9a37a8b88ad59d200ac7d10c56&quot;,
        &quot;ctn&quot;: {
            &quot;errno&quot;: 10086,
            &quot;error&quot;: &quot;您的余额已不足&quot;,
            &quot;context&quot;: {
                &quot;class&quot;: {
                    &quot;id&quot;: 111,
                    &quot;name&quot;: &quot;哮天犬演示课&quot;
                },
                &quot;time&quot;: {
                    &quot;date&quot;: &quot;2020-06-17&quot;,
                    &quot;time&quot;: &quot;15:30:00&quot;
                }
            }
        },
        &quot;level&quot;: 1,
        &quot;notice_time&quot;: 1592378746
    }'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>我们可以在通知模板中配置如下模板：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>您有一条告警，请注意处理
错误码：{history.ctn.errno}
错误信息：{history.ctn.error}
课程：{history.ctn.context.class.name}（ID：{history.ctn.context.class.id}）
时间：{history.ctn.context.time}
Host：{history.ctn.hostname}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>我们接收到告警的内容将是：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>您有一条告警，请注意处理
错误码：10086
错误信息：您的余额已不足
课程：哮天犬演示课（ID：111）
时间：{&quot;date&quot;: &quot;2020-06-17&quot;, &quot;time&quot;: &quot;15:30:00&quot;}
Host：{history.ctn.hostname}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>从上面的示例可以看出，告警模板实际上是将模板中格式为 <code>{}</code> 的特殊标记（以下都称为模板变量）替换为告警内容中JSON对应key的值，如果值为标量，则原样输出，例如 <code>{history.ctn.errno}</code>；如果值为非标量，则输出为JSON字符串，例如 <code>{history.ctn.context.time}</code>；如果对应的key不存在，则不进行替换，例如 <code>{history.ctn.hostname}</code>。</p> <p>模板变量可以通过小数点 <code>.</code> 访问无限层级的JSON对象<a href="/alarm-dog-docs/preface/concept.html#json数据类型"><sup>[概念介绍]</sup></a>，例如 <code>ctn</code>、<code>context</code>、<code>class</code> 均为JSON对象，所以可以通过 <code>{history.ctn.context.class.name}</code> 访问到 <code>class</code> 对象中的 <code>name</code> 的值。</p> <p>我们还发现 <code>ctn</code> 字段外层还有一个 <code>history</code> 字段，这个字段相当于是命名空间，因为哮天犬提供了很多模板变量，为了很好的区分各变量的含义，故在变量的前面加了命名空间。<code>history</code> 表示的是告警记录这组变量的命名空间，哮天犬还提供了其他的可以变量，请参考<a href="#%E5%8F%AF%E7%94%A8%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F">可用模板变量</a>。</p> <h2 id="模板场景"><a href="#模板场景" class="header-anchor">#</a> 模板场景</h2> <p>告警场景主要是根据四种不同需要告警发送的高级功能出现的，包括告警被收敛、告警未收敛、告警升级、告警恢复四种场景。告警属于哪种模板场景就是用哪个场景下的模板发送告警。</p> <p><img src="/alarm-dog-docs/assets/img/d2d5e989b08fecbb558537b5c3db62bf2b9915e0103fe33de607a0d05f9d2519.4da7aaa8.png" alt="图 17"></p> <h3 id="告警被收敛"><a href="#告警被收敛" class="header-anchor">#</a> 告警被收敛</h3> <p>即告警任务开启了告警收敛功能，且告警命中了收敛规则，此时会以告警被收敛的场景发送告警。</p> <h3 id="告警未收敛"><a href="#告警未收敛" class="header-anchor">#</a> 告警未收敛</h3> <p>即告警未开启收敛功能，或者开启了收敛功能但未命中收敛规则，此时会以告警未收敛的场景发送告警。</p> <h3 id="告警升级"><a href="#告警升级" class="header-anchor">#</a> 告警升级</h3> <p>即告警开启了告警升级功能，且触发了告警升级，此时会以告警升级的场景发送告警。</p> <h3 id="告警恢复"><a href="#告警恢复" class="header-anchor">#</a> 告警恢复</h3> <p>即告警开启了告警恢复功能，且触发了告警恢复，此时会以告警恢复的场景发送告警。</p> <h2 id="模板类型"><a href="#模板类型" class="header-anchor">#</a> 模板类型</h2> <p>告警模板分为三种类型，分别为预定义模板、自定义模板、默认模板。</p> <h3 id="预定义模板"><a href="#预定义模板" class="header-anchor">#</a> 预定义模板</h3> <p>预定义模板指的是通过在哮天犬后台 【告警管理 / 通知模板】菜单创建的模板，此处的模板可以关联到任意告警任务中，可以很好的实现告警模板的复用。预定义模板里面每个告警场景、告警通知渠道有可能是自定义模板或者默认模板，但至少有一个是自定义模板。</p> <p><img src="/alarm-dog-docs/assets/img/42bb2539b306c2118ff5d632d5b2fd13fcdb7108717969f07959d48d321b034e.badcedc6.png" alt="图 14"></p> <p><img src="/alarm-dog-docs/assets/img/5d48aedb41eab2d1f41a9d66a831df23f71413808735536b08df73388567164b.953629e1.png" alt="图 15"></p> <h3 id="自定义模板"><a href="#自定义模板" class="header-anchor">#</a> 自定义模板</h3> <p>如图所示，某个告警场景的告警通知渠道模板内容被修改，这种模板属于自定义模板，即被修改过的模板。自定义模板能根据自己想要的格式进行修改，能增加告警的可读性，建议修改默认模板。</p> <p><img src="/alarm-dog-docs/assets/img/5be6cf4792e5744e767b42c7a8314387c613aa29a7c7097d5992eb975220d5fe.f43adcb6.png" alt="图 16"></p> <h3 id="默认模板"><a href="#默认模板" class="header-anchor">#</a> 默认模板</h3> <p>如上图所示，模板没有做任何修改，这种模板为默认模板。默认模板发送时会使用系统默认的模板发送告警，有可能存在哮天犬平台调整默认模板导致告警发送内容稍有差异。且为了能使任何告警内容输出，告警内容会以 <code>{history.ctn}</code> 的模板变量使用JSON的形式发送到通知人，可能会影响可读性，建议配置告警模板。</p> <h2 id="可用模板变量"><a href="#可用模板变量" class="header-anchor">#</a> 可用模板变量</h2> <h3 id="告警收敛场景"><a href="#告警收敛场景" class="header-anchor">#</a> 告警收敛场景</h3> <ul><li><code>task</code>：告警任务信息
<ul><li><code>task.id</code>: 告警任务ID</li> <li><code>task.name</code>: 告警任务名称</li></ul></li> <li><code>history</code>: 告警记录
<ul><li><code>history.id</code>: 告警记录ID</li> <li><code>history.uuid</code>: 告警记录唯一ID</li> <li><code>history.batch</code>: 收敛批次</li> <li><code>history.metric</code>: 收敛指标</li> <li><code>history.notice_time</code>: 告警通知时间</li> <li><code>history.level</code>: 告警级别</li> <li><code>history.ctn</code>: 告警内容</li> <li><code>history.receiver</code>: 自定义通知人配置，JSON格式，如果未传则为空</li></ul></li> <li><code>common</code>: 系统变量
<ul><li><code>common.env</code>: 环境标识，例如 [生产环境]、[测试环境]</li></ul></li></ul> <h3 id="告警未收敛场景"><a href="#告警未收敛场景" class="header-anchor">#</a> 告警未收敛场景</h3> <ul><li><code>task</code>：告警任务信息
<ul><li><code>task.id</code>: 告警任务ID</li> <li><code>task.name</code>: 告警任务名称</li></ul></li> <li><code>history</code>: 告警记录
<ul><li><code>history.uuid</code>: 告警记录唯一ID</li> <li><code>history.notice_time</code>: 告警通知时间</li> <li><code>history.level</code>: 告警级别</li> <li><code>history.ctn</code>: 告警内容</li> <li><code>history.receiver</code>: 自定义通知人配置，JSON格式，如果未传则为空</li></ul></li> <li><code>common</code>: 系统变量
<ul><li><code>common.env</code>: 环境标识，例如 [生产环境]、[测试环境]</li></ul></li></ul> <h3 id="告警升级场景"><a href="#告警升级场景" class="header-anchor">#</a> 告警升级场景</h3> <ul><li><code>task</code>：告警任务信息
<ul><li><code>task.id</code>: 告警任务ID</li> <li><code>task.name</code>: 告警任务名称</li></ul></li> <li><code>context</code>: 上下文配置信息
<ul><li><code>context.rule</code>: 当前告警升级规则配置，JSON格式</li> <li><code>context.zcount</code>: 触发规则的计数值</li></ul></li> <li><code>history</code>: 告警记录
<ul><li><code>history.id</code>: 告警记录ID</li> <li><code>history.uuid</code>: 告警记录唯一ID</li> <li><code>history.batch</code>: 收敛批次</li> <li><code>history.metric</code>: 收敛指标</li> <li><code>history.notice_time</code>: 告警通知时间</li> <li><code>history.level</code>: 告警级别</li> <li><code>history.ctn</code>: 告警内容</li> <li><code>history.receiver</code>: 自定义通知人配置，JSON格式，如果未传则为空</li></ul></li> <li><code>common</code>: 系统变量
<ul><li><code>common.env</code>: 环境标识，例如 [生产环境]、[测试环境]</li></ul></li></ul> <h3 id="告警恢复场景"><a href="#告警恢复场景" class="header-anchor">#</a> 告警恢复场景</h3> <ul><li><code>task</code>：告警任务信息
<ul><li><code>task.id</code>: 告警任务ID</li> <li><code>task.name</code>: 告警任务名称</li></ul></li> <li><code>history</code>: 告警记录
<ul><li><code>history.uuid</code>: 告警记录唯一ID</li> <li><code>history.notice_time</code>: 告警通知时间</li> <li><code>history.level</code>: 告警级别</li> <li><code>history.ctn</code>: 告警内容</li> <li><code>history.receiver</code>: 自定义通知人配置，JSON格式，如果未传则为空</li></ul></li> <li><code>common</code>: 系统变量
<ul><li><code>common.env</code>: 环境标识，例如 [生产环境]、[测试环境]</li></ul></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/tal-tech/alarm-dog/edit/master/docs/advance-function/alarm-template.md" target="_blank" rel="noopener noreferrer">哮天犬后台</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">11/25/2020, 3:10:40 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/alarm-dog-docs/advance-function/dispatcher.html" class="prev">
        分级告警
      </a></span> <span class="next"><a href="/alarm-dog-docs/advance-function/recovery.html">
        自动恢复
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/alarm-dog-docs/assets/js/app.af20afb1.js" defer></script><script src="/alarm-dog-docs/assets/js/2.d68acc10.js" defer></script><script src="/alarm-dog-docs/assets/js/11.a92c3c0c.js" defer></script>
  </body>
</html>
